<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta http-equiv="expires" content="0">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
</head>
<!-- Pleace this snippet right after opening the head tag to make it work properly -->

<!-- This code is licensed under GNU GPL v3 -->
<!-- You are allowed to freely copy, distribute and use this code, but removing author credit is strictly prohibited -->
<!-- Generated by http://insider.zone/tools/client-side-url-redirect-generator/ -->

<!-- REDIRECTING STARTS -->
<!--[if lt IE 9]><script type="text/javascript">var IE_fix=true;</script><![endif]-->
<script type="text/javascript">
    function redirect(url) {
        if(typeof IE_fix != "undefined") // IE8 and lower fix to pass the http referer
        {
            document.write("redirecting..."); // Don't remove this line or appendChild() will fail because it is called before document.onload to make the redirect as fast as possible. Nobody will see this text, it is only a tech fix.
            var referLink = document.createElement("a");
            referLink.href = url;
            document.body.appendChild(referLink);
            referLink.click();
        }
        else { window.location.replace(url); } // All other browsers
    }
</script>
<!-- Credit goes to http://insider.zone/ -->
<!-- REDIRECTING ENDS -->


<body>
    <h1>Redirecting...</h1>
</body>
<div id="ppl1"></div>
<div id="ppl2"></div>
</html>

<script>
    var NEXT_URL = "http://ec2-34-222-0-48.us-west-2.compute.amazonaws.com:8000";
    var EXP_1 = "61122e9417587c146fe3d4e8bf2d0d";
    var EXP_2 = "c43517ce88585caab92d03cbdf9a57";

    var next_url = NEXT_URL;
    var url = next_url + "/dashboard/get_stats";

    $.post({
      'url': url,
      'data': JSON.stringify({
        'exp_uid': EXP_1,
        'args': {
            'stat_id' : 'basic_info',
            'params':{},
            'force_recompute': false,
        }
      }),
      'contentType': 'application/json',
      'dataType': 'json',
    }).done(function (exp1_data) {
      console.log("got exp1 data:", exp1_data);

      $.post({
        'url': url,
        'data': JSON.stringify({
          'exp_uid': EXP_2,
          'args': {
              'stat_id' : 'basic_info',
              'params':{},
              'force_recompute': false,
          }
        }),
        'contentType': 'application/json',
        'dataType': 'json',
      }).done(function (exp2_data) {
        console.log("got exp2 data:", exp2_data);
        var exp;
        if (exp1_data.num_participants < exp2_data.num_participants) {
          exp = EXP_1;
        } else {
          exp = EXP_2;
        }
        //alert(exp);
        redirect(NEXT_URL + "/query/query_page/query_page/" + exp);
      });
    });
</script>
